@model YastCleaner.Web.ViewModels.DetallePedidoViewModel

@{
    ViewData["Title"] = "Detalle del Pedido";
}

@section Styles {
    <link rel="stylesheet" href="~/css/DetallePedido.css" />
}
<div class="detalle-pedido-container">
    <!-- Header de la página -->
    <div class="page-header">
        <h1 class="page-title">Detalle del Pedido</h1>
        @if (TempData["Mensaje"] != null)
        {
            <div class="alert-message">
                <i class="fas fa-info-circle me-2"></i>@TempData["Mensaje"]
            </div>
        }
    </div>

    <!-- Información principal del pedido -->
    <div class="card-custom">
        <div class="card-header-custom">
            <h4>Pedido: @Model.CodigoPedido</h4>
        </div>
        <div class="card-body-custom">
            <div class="detail-list">
                <div class="detail-item">
                    <span class="detail-label">Fecha y Hora:</span>
                    <span class="detail-value">@Model.Fecha.ToString("dd/MM/yyyy HH:mm")</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Estado:</span>
                    <span class="detail-value">
                        <span class="estado-badge estado-@Model.Estado.ToLower()">@Model.Estado</span>
                    </span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Método de Pago:</span>
                    <span class="detail-value">@Model.MetodoPago</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Monto Adelantado:</span>
                    <span class="detail-value detail-amount">@Model.MontoAdelantado.ToString("C")</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Monto Faltante:</span>
                    <span class="detail-value detail-amount">@Model.MontoFaltante.ToString("C")</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Monto Total:</span>
                    <span class="detail-value detail-amount">@Model.Detalles.Sum(d => d.SubTotal).ToString("C")</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Información de Cliente y Trabajador -->
    <div class="info-grid">
        <!-- Cliente -->
        <div class="info-section">
            <div class="person-info">
                <div class="person-header">
                    <div class="person-avatar">
                        @Model.Cliente.Nombre.Substring(0, 1)@Model.Cliente.ApellidoPaterno.Substring(0, 1)
                    </div>
                    <div class="person-details">
                        <div class="person-name">@Model.Cliente.Nombre @Model.Cliente.ApellidoPaterno @Model.Cliente.ApellidoMaterno</div>
                        <div class="person-id">ID: @Model.Cliente.ClienteId</div>
                    </div>
                </div>
                <div class="person-data">
                    <div class="data-item">
                        <div class="data-label">Correo:</div>
                        <div class="data-value">@Model.Cliente.Email</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Celular:</div>
                        <div class="data-value">@Model.Cliente.NumeroCelular</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Dirección:</div>
                        <div class="data-value">@Model.Cliente.Direccion</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Registro:</div>
                        <div class="data-value">@Model.Cliente.FechaRegistro.ToString("dd/MM/yyyy")</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Trabajador -->
        <div class="info-section">
            <div class="person-info">
                <div class="person-header">
                    <div class="person-avatar">
                        @Model.Trabajador.Nombre.Substring(0, 1)@Model.Trabajador.Apellidos.Substring(0, 1)
                    </div>
                    <div class="person-details">
                        <div class="person-name">@Model.Trabajador.Nombre @Model.Trabajador.Apellidos</div>
                        <div class="person-id">ID: @Model.Trabajador.TrabajadorId</div>
                    </div>
                </div>
                <div class="person-data">
                    <div class="data-item">
                        <div class="data-label">DNI:</div>
                        <div class="data-value">@Model.Trabajador.Dni</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Correo:</div>
                        <div class="data-value">@Model.Trabajador.Email</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Dirección:</div>
                        <div class="data-value">@Model.Trabajador.Direccion</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Registro:</div>
                        <div class="data-value">@Model.Trabajador.FechaRegistro.ToString("dd/MM/yyyy")</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Servicios del Pedido -->
    <div class="servicios-section">
        <h3 class="section-title">Servicios del Pedido</h3>
        <div class="table-responsive">
            <table class="table table-custom">
                <thead>
                    <tr>
                        <th>Servicio</th>
                        <th>Cantidad</th>
                        <th>Precio Unitario</th>
                        <th>Subtotal</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var detalle in Model.Detalles)
                    {
                        <tr>
                            <td>
                                <strong>@detalle.NombreServicio</strong>
                                <br>
                                <small class="text-muted">ID: @detalle.ServicioId</small>
                            </td>
                            <td>@detalle.Cantidad</td>
                            <td>@detalle.Precio.ToString("C")</td>
                            <td><strong>@detalle.SubTotal.ToString("C")</strong></td>
                        </tr>
                    }
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="3" class="text-end"><strong>Total:</strong></td>
                        <td><strong class="detail-amount">@Model.Detalles.Sum(d => d.SubTotal).ToString("C")</strong></td>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>

    <!-- Botones de acción -->
    <div class="action-buttons">
        <a asp-controller="Home" asp-action="Index" class="btn-custom btn-secondary">
            <i class="fas fa-arrow-left"></i> Salir
        </a>
        <a asp-controller="Pedido" asp-action="Entregar" asp-route-pedidoId="@Model.PedidoId" class="btn-custom btn-primary">
            <i class="fas fa-check-circle"></i> Entregar Pedido
        </a>
        <a asp-controller="Pedido" asp-action="Anular" asp-route-pedidoId="@Model.PedidoId" class="btn-custom btn-danger">
            <i class="fas fa-times-circle"></i> Anular Pedido
        </a>
    </div>
</div>